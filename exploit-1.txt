Odgvori na pitanja:

1. Međuspremnik koji može biti prekoračen:

Riječ je o bufferu
char reqpath[4096];
Nalazi se u funkciji process_client u datoteci zookd.c i alociran je na stogu.

Ovaj buffer se koristi u funkciji http_request_line koja se poziva na sljedeći način:
http_request_line(fd, reqpath, env, &env_len);


2. Struktura ulaza poslužitelju:

U funkciji http_request_line poziva se funkcija:
url_decode(reqpath, sp1);

Ona dekodira escape sekvence iz URL-a (npr. %20 → ' ', %26 → '&') i rezultat zapisuje u buffer reqpath. Ako korisnik uputi HTTP zahtjev s jako dugim stringom nakon znaka '?', kao npr: GET /index.html?aaaa...aaaa HTTP/1.0

i ako taj string nakon dekodiranja bude duži od 4096 bajtova, može doći do preljeva međuspremnika reqpath i prepisivanja memorije, uključujući i povratnu adresu funkcije.


3. Call stack:     process_client() -> http_request_line() -> url_decode()
 
